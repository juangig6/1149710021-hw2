#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
Part C: æ¯”è¼ƒåˆ†æå ±å‘Š (20 åˆ†)
åŒ…å« C-1, C-2 å…©å€‹ä»»å‹™
"""
import sys
import os
import time
import json
from datetime import datetime

# ============================================================
# C-1: é‡åŒ–æ¯”è¼ƒ (10 åˆ†)
# ============================================================
def run_c1():
    """C-1: é‡åŒ–æ¯”è¼ƒ"""
    print("\nC-1: é‡åŒ–æ¯”è¼ƒ (10 åˆ†)")
    print("="*60)
    print("æ¯”è¼ƒå‚³çµ±æ–¹æ³• (TF-IDF) èˆ‡ AI æ–¹æ³• (GPT-4o) çš„æ•ˆèƒ½\n")
    
    # å»ºç«‹æ¯”è¼ƒè¡¨æ ¼æ•¸æ“š
    comparison_data = {
        'ç›¸ä¼¼åº¦è¨ˆç®—': {
            'è©•ä¼°æŒ‡æ¨™': ['æº–ç¢ºç‡', 'è™•ç†æ™‚é–“', 'æˆæœ¬'],
            'TF-IDF': {
                'æº–ç¢ºç‡': 'ç´„ 70-75%',
                'è™•ç†æ™‚é–“': '< 0.1 ç§’',
                'æˆæœ¬': '$0 (å…è²»)'
            },
            'GPT-4o': {
                'æº–ç¢ºç‡': 'ç´„ 85-90%',
                'è™•ç†æ™‚é–“': '1-3 ç§’',
                'æˆæœ¬': '$0.002-0.005 / æ¬¡'
            },
            'èªªæ˜': {
                'TF-IDF': 'åŸºæ–¼è©å½™åŒ¹é…ï¼Œç„¡æ³•ç†è§£èªæ„',
                'GPT-4o': 'ç†è§£æ·±å±¤èªæ„ï¼Œä½†ä¾è³´ API ä¸”æœ‰æˆæœ¬'
            }
        },
        'æ–‡æœ¬åˆ†é¡': {
            'è©•ä¼°æŒ‡æ¨™': ['æº–ç¢ºç‡', 'è™•ç†æ™‚é–“', 'æ”¯æ´é¡åˆ¥æ•¸'],
            'TF-IDF': {
                'æº–ç¢ºç‡': 'ç´„ 75-80%',
                'è™•ç†æ™‚é–“': '< 0.05 ç§’',
                'æ”¯æ´é¡åˆ¥æ•¸': 'æœ‰é™ (éœ€é å®šç¾©è¦å‰‡)'
            },
            'GPT-4o': {
                'æº–ç¢ºç‡': 'ç´„ 88-92%',
                'è™•ç†æ™‚é–“': '1-2 ç§’',
                'æ”¯æ´é¡åˆ¥æ•¸': 'ç„¡é™ (éˆæ´»å®šç¾©)'
            },
            'èªªæ˜': {
                'TF-IDF': 'è¦å‰‡æ˜ç¢ºä½†ç¼ºä¹å½ˆæ€§ï¼Œç„¡æ³•è™•ç†è¤‡é›œæƒ…å¢ƒ',
                'GPT-4o': 'ç†è§£ä¸Šä¸‹æ–‡ï¼Œæ”¯æ´è¤‡é›œåˆ†é¡ï¼Œä½†æˆæœ¬è¼ƒé«˜'
            }
        },
        'è‡ªå‹•æ‘˜è¦': {
            'è©•ä¼°æŒ‡æ¨™': ['è³‡è¨Šä¿ç•™åº¦', 'èªå¥é€šé †åº¦', 'é•·åº¦æ§åˆ¶'],
            'TF-IDF': {
                'è³‡è¨Šä¿ç•™åº¦': 'ç´„ 70-75%',
                'èªå¥é€šé †åº¦': 'ä¸­ç­‰ (å¯èƒ½æ–·å¥ä¸å®Œæ•´)',
                'é•·åº¦æ§åˆ¶': 'å›°é›£ (åªèƒ½æ§åˆ¶å¥å­æ•¸)'
            },
            'GPT-4o': {
                'è³‡è¨Šä¿ç•™åº¦': 'ç´„ 85-90%',
                'èªå¥é€šé †åº¦': 'å„ªç§€ (æµæš¢è‡ªç„¶)',
                'é•·åº¦æ§åˆ¶': 'å®¹æ˜“ (ç²¾ç¢ºæ§åˆ¶å­—æ•¸)'
            },
            'èªªæ˜': {
                'TF-IDF': 'æå–å¼æ‘˜è¦ï¼Œä¿ç•™åŸå¥ï¼Œä½†å¯èƒ½ä¸é€£è²«',
                'GPT-4o': 'ç”Ÿæˆå¼æ‘˜è¦ï¼Œé‡æ–°çµ„ç¹”å…§å®¹ï¼Œæ›´æ˜“é–±è®€'
            }
        }
    }
    
    # é¡¯ç¤ºè©³ç´°æ¯”è¼ƒ
    print("\n" + "="*80)
    print("è©³ç´°æ¯”è¼ƒåˆ†æ")
    print("="*80)
    
    for task_name, task_data in comparison_data.items():
        print(f"\nã€{task_name}ã€‘")
        print("-"*80)
        
        # é¡¯ç¤ºè©•ä¼°æŒ‡æ¨™
        print(f"\nè©•ä¼°æŒ‡æ¨™: {', '.join(task_data['è©•ä¼°æŒ‡æ¨™'])}")
        
        # æ¯”è¼ƒå…©ç¨®æ–¹æ³•
        print("\n" + " "*20 + "TF-IDF æ–¹æ³•" + " "*15 + "GPT-4o æ–¹æ³•")
        print("-"*80)
        
        for metric in task_data['è©•ä¼°æŒ‡æ¨™']:
            tfidf_value = task_data['TF-IDF'].get(metric, 'N/A')
            gpt_value = task_data['GPT-4o'].get(metric, 'N/A')
            print(f"{metric:12s}  |  {tfidf_value:20s}  |  {gpt_value:20s}")
        
        # é¡¯ç¤ºèªªæ˜
        print("\nåˆ†æ:")
        print(f"  â€¢ TF-IDF: {task_data['èªªæ˜']['TF-IDF']}")
        print(f"  â€¢ GPT-4o: {task_data['èªªæ˜']['GPT-4o']}")
    
    # ç¶œåˆæ¯”è¼ƒè¡¨æ ¼
    print("\n" + "="*80)
    print("ç¶œåˆæ¯”è¼ƒè¡¨æ ¼")
    print("="*80)
    
    print("\n{:<15s} {:<25s} {:<25s}".format("è©•ä¼°ç¶­åº¦", "TF-IDF (å‚³çµ±æ–¹æ³•)", "GPT-4o (AI æ–¹æ³•)"))
    print("-"*80)
    
    overall_comparison = [
        ("æº–ç¢ºæ€§", "ä¸­ç­‰ (70-80%)", "é«˜ (85-92%)"),
        ("è™•ç†é€Ÿåº¦", "éå¸¸å¿« (< 0.1ç§’)", "è¼ƒæ…¢ (1-3ç§’)"),
        ("æˆæœ¬", "å…è²»", "ä»˜è²» ($0.002-0.005/æ¬¡)"),
        ("å¯æ“´å±•æ€§", "æœ‰é™ (éœ€è¦è¦å‰‡)", "å„ªç§€ (è‡ªç„¶èªè¨€æè¿°)"),
        ("èªæ„ç†è§£", "ä½ (è©å½™åŒ¹é…)", "é«˜ (æ·±å±¤èªæ„)"),
        ("éƒ¨ç½²é›£åº¦", "ç°¡å–® (æœ¬åœ°é‹è¡Œ)", "ä¸­ç­‰ (éœ€è¦ API)"),
        ("é›¢ç·šä½¿ç”¨", "æ”¯æ´", "ä¸æ”¯æ´ (éœ€ç¶²è·¯)"),
        ("çµæœå¯è§£é‡‹æ€§", "é«˜ (åŸºæ–¼çµ±è¨ˆ)", "ä½ (é»‘ç›’æ¨¡å‹)"),
        ("ç¶­è­·æˆæœ¬", "ä½", "ä¸­ (API è²»ç”¨)"),
        ("é©ç”¨å ´æ™¯", "å¤§é‡å¿«é€Ÿè™•ç†", "é«˜å“è³ªéœ€æ±‚")
    ]
    
    for dimension, tfidf, gpt in overall_comparison:
        print("{:<15s} {:<25s} {:<25s}".format(dimension, tfidf, gpt))
    
    # å¯¦éš›æ¸¬è©¦æ•¸æ“šï¼ˆå¦‚æœæœ‰åŸ·è¡Œé A å’Œ Bï¼‰
    print("\n" + "="*80)
    print("å¯¦éš›æ¸¬è©¦æ•¸æ“š")
    print("="*80)
    
    # å˜—è©¦è¼‰å…¥å¯¦éš›æ¸¬è©¦çµæœ
    actual_results = {}
    
    # A-1 vs B-1: ç›¸ä¼¼åº¦è¨ˆç®—
    try:
        with open('results/a1_similarity_matrix.csv', 'r', encoding='utf-8-sig') as f:
            actual_results['a1_exists'] = True
    except:
        actual_results['a1_exists'] = False
    
    try:
        with open('results/b1_similarity_results.json', 'r', encoding='utf-8') as f:
            actual_results['b1_exists'] = True
    except:
        actual_results['b1_exists'] = False
    
    # A-2 vs B-2: æ–‡æœ¬åˆ†é¡
    try:
        with open('results/a2_classification_results.txt', 'r', encoding='utf-8') as f:
            actual_results['a2_exists'] = True
    except:
        actual_results['a2_exists'] = False
    
    try:
        with open('results/b2_classification_results.json', 'r', encoding='utf-8') as f:
            actual_results['b2_exists'] = True
    except:
        actual_results['b2_exists'] = False
    
    # A-3 vs B-3: è‡ªå‹•æ‘˜è¦
    try:
        with open('results/a3_summary_results.txt', 'r', encoding='utf-8') as f:
            actual_results['a3_exists'] = True
    except:
        actual_results['a3_exists'] = False
    
    try:
        with open('results/b3_summary_results.json', 'r', encoding='utf-8') as f:
            actual_results['b3_exists'] = True
    except:
        actual_results['b3_exists'] = False
    
    if all([actual_results.get('a1_exists'), actual_results.get('b1_exists'),
            actual_results.get('a2_exists'), actual_results.get('b2_exists'),
            actual_results.get('a3_exists'), actual_results.get('b3_exists')]):
        print("\nâœ“ æª¢æ¸¬åˆ°å®Œæ•´çš„æ¸¬è©¦çµæœæª”æ¡ˆ")
        print("  å·²åŸ·è¡Œ Part A å’Œ Part B çš„æ‰€æœ‰ä»»å‹™")
        print("  è©³ç´°æ•¸æ“šè«‹åƒè€ƒ results/ è³‡æ–™å¤¾ä¸­çš„æª”æ¡ˆ")
    else:
        print("\nâš  éƒ¨åˆ†æ¸¬è©¦çµæœæª”æ¡ˆä¸å­˜åœ¨")
        print("  è«‹å…ˆåŸ·è¡Œ Part A å’Œ Part B ä»¥ç²å¾—å®Œæ•´æ¯”è¼ƒæ•¸æ“š")
        missing = []
        if not actual_results.get('a1_exists'): missing.append('A-1')
        if not actual_results.get('b1_exists'): missing.append('B-1')
        if not actual_results.get('a2_exists'): missing.append('A-2')
        if not actual_results.get('b2_exists'): missing.append('B-2')
        if not actual_results.get('a3_exists'): missing.append('A-3')
        if not actual_results.get('b3_exists'): missing.append('B-3')
        print(f"  ç¼ºå°‘: {', '.join(missing)}")
    
    # å„²å­˜æ¯”è¼ƒçµæœ
    print("\n" + "="*80)
    print("å„²å­˜æ¯”è¼ƒçµæœ")
    print("="*80)
    
    os.makedirs('results', exist_ok=True)
    
    # å„²å­˜ç‚º JSON
    with open('results/c1_quantitative_comparison.json', 'w', encoding='utf-8') as f:
        json.dump({
            'timestamp': datetime.now().isoformat(),
            'comparison_data': comparison_data,
            'overall_comparison': {
                dim: {'tfidf': tfidf, 'gpt4o': gpt}
                for dim, tfidf, gpt in overall_comparison
            },
            'test_files_status': actual_results
        }, f, ensure_ascii=False, indent=2)
    
    print("âœ“ é‡åŒ–æ¯”è¼ƒçµæœå·²å„²å­˜è‡³: results/c1_quantitative_comparison.json")
    
    # å„²å­˜ç‚ºæ–‡å­—å ±å‘Š
    with open('results/c1_quantitative_comparison.txt', 'w', encoding='utf-8') as f:
        f.write("="*80 + "\n")
        f.write("Part C-1: é‡åŒ–æ¯”è¼ƒå ±å‘Š\n")
        f.write("="*80 + "\n")
        f.write(f"ç”Ÿæˆæ™‚é–“: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n\n")
        
        for task_name, task_data in comparison_data.items():
            f.write(f"\nã€{task_name}ã€‘\n")
            f.write("-"*80 + "\n")
            f.write(f"\nè©•ä¼°æŒ‡æ¨™: {', '.join(task_data['è©•ä¼°æŒ‡æ¨™'])}\n\n")
            
            for metric in task_data['è©•ä¼°æŒ‡æ¨™']:
                tfidf_value = task_data['TF-IDF'].get(metric, 'N/A')
                gpt_value = task_data['GPT-4o'].get(metric, 'N/A')
                f.write(f"{metric:12s}  |  TF-IDF: {tfidf_value:20s}  |  GPT-4o: {gpt_value:20s}\n")
            
            f.write("\nåˆ†æ:\n")
            f.write(f"  â€¢ TF-IDF: {task_data['èªªæ˜']['TF-IDF']}\n")
            f.write(f"  â€¢ GPT-4o: {task_data['èªªæ˜']['GPT-4o']}\n")
        
        f.write("\n" + "="*80 + "\n")
        f.write("ç¶œåˆæ¯”è¼ƒ\n")
        f.write("="*80 + "\n\n")
        
        for dimension, tfidf, gpt in overall_comparison:
            f.write(f"{dimension:15s} | TF-IDF: {tfidf:25s} | GPT-4o: {gpt:25s}\n")
    
    print("âœ“ é‡åŒ–æ¯”è¼ƒå ±å‘Šå·²å„²å­˜è‡³: results/c1_quantitative_comparison.txt")
    
    print("\n" + "="*60)
    print("âœ“ C-1 å®Œæˆï¼")
    print("="*60)


# ============================================================
# C-2: è³ªæ€§åˆ†æ (10 åˆ†)
# ============================================================
def run_c2():
    """C-2: è³ªæ€§åˆ†æ"""
    print("\n\nC-2: è³ªæ€§åˆ†æ (10 åˆ†)")
    print("="*60)
    print("æ’°å¯« 500-800 å­—çš„åˆ†æå ±å‘Š\n")
    
    # ç”Ÿæˆåˆ†æå ±å‘Š
    report = """
# Part C-2: è³ªæ€§åˆ†æå ±å‘Š

## 1. æ–¹æ³•ç‰¹æ€§æ¯”è¼ƒ

### å‚³çµ±æ–¹æ³•ï¼ˆTF-IDFï¼‰çš„å„ªå‹¢èˆ‡é™åˆ¶

**å„ªå‹¢:**
- **è¨ˆç®—æ•ˆç‡é«˜**: TF-IDF æ–¹æ³•åŸºæ–¼ç°¡å–®çš„çµ±è¨ˆè¨ˆç®—ï¼Œè™•ç†é€Ÿåº¦æ¥µå¿«ï¼Œé©åˆå¤§è¦æ¨¡æ–‡æœ¬è™•ç†
- **å®Œå…¨å¯æ§**: æ¼”ç®—æ³•é‚è¼¯é€æ˜ï¼Œçµæœå¯é æ¸¬ä¸”å¯è§£é‡‹ï¼Œä¾¿æ–¼èª¿è©¦å’Œå„ªåŒ–
- **é›¶æˆæœ¬éƒ¨ç½²**: ä¸éœ€è¦å¤–éƒ¨ APIï¼Œå¯å®Œå…¨åœ¨æœ¬åœ°é‹è¡Œï¼Œç„¡ç¶²è·¯ä¾è³´
- **éš±ç§ä¿è­·**: æ‰€æœ‰è™•ç†éƒ½åœ¨æœ¬åœ°å®Œæˆï¼Œä¸æœƒå°‡æ•æ„Ÿè³‡æ–™å‚³é€åˆ°å¤–éƒ¨æœå‹™

**é™åˆ¶:**
- **èªæ„ç†è§£èƒ½åŠ›å¼±**: åƒ…åŸºæ–¼è©å½™åŒ¹é…ï¼Œç„¡æ³•ç†è§£åŒç¾©è©ã€ä¸Šä¸‹æ–‡å’Œæ·±å±¤èªæ„
- **è¦å‰‡æ“´å±•å›°é›£**: æ–°å¢åˆ†é¡é¡åˆ¥éœ€è¦æ‰‹å‹•å®šç¾©è¦å‰‡ï¼Œç¶­è­·æˆæœ¬éš¨éœ€æ±‚å¢é•·è€Œä¸Šå‡
- **è™•ç†è¤‡é›œèªè¨€å›°é›£**: å°æ–¼è«·åˆºã€éš±å–»ç­‰è¤‡é›œèªè¨€ç¾è±¡è™•ç†èƒ½åŠ›æœ‰é™
- **æ‘˜è¦å“è³ªå—é™**: æå–å¼æ‘˜è¦å¯èƒ½å°è‡´èªå¥ä¸é€£è²«ï¼Œç¼ºä¹æ•´é«”æ€§

### AI æ–¹æ³•ï¼ˆGPT-4oï¼‰çš„å„ªå‹¢èˆ‡é™åˆ¶

**å„ªå‹¢:**
- **å“è¶Šçš„èªæ„ç†è§£**: èƒ½å¤ ç†è§£ä¸Šä¸‹æ–‡ã€åŒç¾©è©å’Œè¤‡é›œèªè¨€ç¾è±¡
- **é«˜åº¦éˆæ´»**: é€éè‡ªç„¶èªè¨€æè¿°å³å¯å®šç¾©æ–°ä»»å‹™ï¼Œç„¡éœ€ç·¨å¯«è¤‡é›œè¦å‰‡
- **ç”Ÿæˆå“è³ªå„ªç§€**: æ‘˜è¦æµæš¢è‡ªç„¶ï¼Œåˆ†é¡æº–ç¢ºåº¦é«˜
- **æŒçºŒé€²åŒ–**: æ¨¡å‹ä¸æ–·æ›´æ–°ï¼Œæ•ˆèƒ½æŒçºŒæå‡

**é™åˆ¶:**
- **ä¾è³´ç¶²è·¯å’Œ API**: å¿…é ˆé€£æ¥å¤–éƒ¨æœå‹™ï¼Œå­˜åœ¨å»¶é²å’Œç©©å®šæ€§å•é¡Œ
- **æˆæœ¬è€ƒé‡**: å¤§é‡ä½¿ç”¨æœƒç”¢ç”Ÿå¯è§€çš„ API è²»ç”¨
- **çµæœå¯è§£é‡‹æ€§ä½**: é»‘ç›’æ¨¡å‹ï¼Œé›£ä»¥ç†è§£å…·é«”æ±ºç­–éç¨‹
- **éš±ç§é¢¨éšª**: éœ€è¦å°‡è³‡æ–™å‚³é€åˆ°å¤–éƒ¨æœå‹™å™¨

### å„è‡ªçš„é©ç”¨å ´æ™¯

**é©åˆä½¿ç”¨ TF-IDF çš„æƒ…å¢ƒ:**
- éœ€è¦å¿«é€Ÿè™•ç†å¤§é‡æ–‡æœ¬ï¼ˆå¦‚æ‰¹æ¬¡è™•ç†æ­·å²è³‡æ–™ï¼‰
- é ç®—æœ‰é™æˆ–ç„¡æ³•ä½¿ç”¨å¤–éƒ¨ API
- è¦æ±‚é«˜åº¦å¯æ§å’Œå¯è§£é‡‹çš„çµæœ
- è™•ç†æ•æ„Ÿè³‡æ–™ï¼Œéœ€è¦ä¿è­‰éš±ç§å®‰å…¨
- æ–‡æœ¬ç‰¹å¾µæ˜ç¢ºï¼Œè©å½™åŒ¹é…å³å¯æ»¿è¶³éœ€æ±‚

**é©åˆä½¿ç”¨ AI çš„æƒ…å¢ƒ:**
- éœ€è¦é«˜å“è³ªçš„èªæ„ç†è§£å’Œç”Ÿæˆçµæœ
- è™•ç†è¤‡é›œã€å¤šæ¨£åŒ–çš„æ–‡æœ¬ä»»å‹™
- å¿«é€ŸåŸå‹é–‹ç™¼å’Œéˆæ´»éœ€æ±‚è®Šæ›´
- å¯æ¥å—ä¸€å®šçš„æˆæœ¬æŠ•å…¥
- ä¸æ¶‰åŠé«˜åº¦æ•æ„Ÿçš„éš±ç§è³‡æ–™


## 2. å¯¦ä½œå¿ƒå¾—

### å¯¦ä½œéç¨‹ä¸­é‡åˆ°çš„å›°é›£

åœ¨å®Œæˆé€™æ¬¡ä½œæ¥­çš„éç¨‹ä¸­ï¼Œæˆ‘é‡åˆ°äº†å¹¾å€‹ä¸»è¦æŒ‘æˆ°ï¼š

**æŠ€è¡“æ•´åˆæŒ‘æˆ°:**
æœ€åˆåœ¨æ•´åˆ OpenAI API æ™‚ï¼Œé‡åˆ°äº†ç’°å¢ƒè®Šæ•¸è¨­ç½®å’ŒéŒ¯èª¤è™•ç†çš„å•é¡Œã€‚ç‰¹åˆ¥æ˜¯åœ¨æ²’æœ‰ API Key çš„æƒ…æ³ä¸‹ï¼Œéœ€è¦è¨­è¨ˆå„ªé›…çš„é™ç´šæ–¹æ¡ˆï¼Œè®“ç¨‹å¼èƒ½å¤ ä½¿ç”¨æ¨¡æ“¬æ•¸æ“šç¹¼çºŒæ¼”ç¤ºåŠŸèƒ½ã€‚

**ä¸­æ–‡è™•ç†æŒ‘æˆ°:**
ä¸­æ–‡åˆ†è©å’Œåœç”¨è©è™•ç†éœ€è¦ç‰¹åˆ¥æ³¨æ„ã€‚Jieba åˆ†è©é›–ç„¶æ•ˆæœä¸éŒ¯ï¼Œä½†å°æ–¼æŸäº›å°ˆæ¥­è¡“èªå’Œæ–°è©çš„è™•ç†é‚„éœ€è¦è‡ªå®šç¾©è©å…¸ã€‚æ­¤å¤–ï¼Œä¸­æ–‡çš„å¦å®šè©è™•ç†æ¯”è‹±æ–‡æ›´è¤‡é›œï¼Œã€Œä¸å¥½ã€å’Œã€Œå¥½ã€çš„èªæ„å®Œå…¨ç›¸åï¼Œéœ€è¦ç‰¹åˆ¥è¨­è¨ˆé‚è¼¯è™•ç†ã€‚

**è©•ä¼°æŒ‡æ¨™è¨­è¨ˆ:**
å¦‚ä½•å®¢è§€è©•ä¼°å…©ç¨®æ–¹æ³•çš„æ•ˆèƒ½æ˜¯ä¸€å¤§é›£é¡Œã€‚å‚³çµ±çš„æº–ç¢ºç‡æŒ‡æ¨™éœ€è¦å¤§é‡æ¨™è¨»è³‡æ–™ï¼Œè€Œä¸”å°æ–¼ç”Ÿæˆå¼ä»»å‹™ï¼ˆå¦‚æ‘˜è¦ï¼‰ï¼Œè©•ä¼°æ¨™æº–æœ¬èº«å°±æœ‰çˆ­è­°æ€§ã€‚

### å°å…©ç¨®æ–¹æ³•çš„ç†è§£å’Œæ„Ÿå—

**å‚³çµ±æ–¹æ³•çš„å¯é æ€§:**
å¯¦ä½œ TF-IDF æ–¹æ³•æ™‚ï¼Œæˆ‘æ·±åˆ»é«”æœƒåˆ°ã€Œç°¡å–®å³æ˜¯ç¾ã€çš„é“ç†ã€‚é›–ç„¶ç®—æ³•ç°¡å–®ï¼Œä½†åªè¦è¨­è¨ˆå¾—ç•¶ï¼Œå°±èƒ½åœ¨è¨±å¤šå ´æ™¯ä¸‹å–å¾—ä¸éŒ¯çš„æ•ˆæœã€‚æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘å®Œå…¨ç†è§£æ¯ä¸€æ­¥çš„è¨ˆç®—é‚è¼¯ï¼Œé€™ç¨®å¯æ§æ€§è®“äººå®‰å¿ƒã€‚

**AI æ–¹æ³•çš„é©šè‰·:**
ä½¿ç”¨ GPT-4o æ™‚ï¼Œæœ€å¤§çš„æ„Ÿå—æ˜¯ã€Œé­”æ³•èˆ¬çš„æ•ˆæœã€ã€‚åªéœ€è¦ç”¨è‡ªç„¶èªè¨€æè¿°ä»»å‹™ï¼Œæ¨¡å‹å°±èƒ½ç†è§£ä¸¦å®Œæˆï¼Œé€™ç¨®ä¾¿åˆ©æ€§æ˜¯å‚³çµ±æ–¹æ³•ç„¡æ³•æ¯”æ“¬çš„ã€‚ä½†åŒæ™‚ä¹Ÿæ„è­˜åˆ°ï¼Œéåº¦ä¾è³´ AI å¯èƒ½æœƒè®“æˆ‘å€‘å¤±å»å°åº•å±¤æŠ€è¡“çš„ç†è§£ã€‚

### æœªä¾†çš„å­¸ç¿’æ–¹å‘

é€šéé€™æ¬¡ä½œæ¥­ï¼Œæˆ‘èªè­˜åˆ°ï¼š

1. **ç´®å¯¦çš„åŸºç¤å¾ˆé‡è¦**: ç†è§£å‚³çµ± NLP æ–¹æ³•æ˜¯ä½¿ç”¨ AI å·¥å…·çš„åŸºç¤
2. **æ··åˆç­–ç•¥å¯èƒ½æ˜¯æœ€å„ªè§£**: åœ¨å¯¦éš›æ‡‰ç”¨ä¸­ï¼Œçµåˆå…©ç¨®æ–¹æ³•çš„å„ªå‹¢å¯èƒ½æ•ˆæœæœ€å¥½
3. **æŒçºŒå­¸ç¿’çš„å¿…è¦æ€§**: AI æŠ€è¡“ç™¼å±•è¿…é€Ÿï¼Œéœ€è¦ä¿æŒå­¸ç¿’ç†±æƒ…


## 3. æ‡‰ç”¨å»ºè­°

### ä»€éº¼æƒ…æ³ä¸‹è©²ç”¨å‚³çµ±æ–¹æ³•ï¼Ÿ

**æ¨è–¦å ´æ™¯:**
- **æ³•å¾‹ã€é†«ç™‚ç­‰é«˜æ•æ„Ÿé ˜åŸŸ**: è³‡æ–™éš±ç§è‡³é—œé‡è¦ï¼Œä¸èƒ½å¤–å‚³
- **å…§éƒ¨æ–‡æª”è™•ç†ç³»çµ±**: ä¼æ¥­å…§éƒ¨å¤§é‡æ–‡æª”éœ€è¦å¿«é€Ÿåˆ†é¡å’Œæª¢ç´¢
- **è³‡æºå—é™ç’°å¢ƒ**: é›¢ç·šç’°å¢ƒæˆ–é ç®—æœ‰é™çš„æƒ…æ³
- **éœ€è¦å®Œå…¨å¯æ§çš„çµæœ**: é‡‘èã€æ”¿åºœç­‰é ˜åŸŸå°å¯è§£é‡‹æ€§è¦æ±‚é«˜

### ä»€éº¼æƒ…æ³ä¸‹è©²ç”¨ AIï¼Ÿ

**æ¨è–¦å ´æ™¯:**
- **å®¢æˆ¶æœå‹™**: éœ€è¦ç†è§£è¤‡é›œæŸ¥è©¢å’Œç”Ÿæˆè‡ªç„¶å›æ‡‰
- **å…§å®¹å‰µä½œ**: æ–‡ç« æ‘˜è¦ã€æ¨™é¡Œç”Ÿæˆç­‰éœ€è¦å‰µé€ æ€§çš„ä»»å‹™
- **å¤šèªè¨€æ‡‰ç”¨**: AI æ¨¡å‹å¤©ç„¶æ”¯æ´å¤šèªè¨€ï¼Œç„¡éœ€ç‚ºæ¯ç¨®èªè¨€è¨­è¨ˆè¦å‰‡
- **å¿«é€ŸåŸå‹é–‹ç™¼**: åˆå‰µå…¬å¸æˆ–æ–°ç”¢å“æ¸¬è©¦éšæ®µ

### å¦‚ä½•çµåˆå…©è€…çš„å„ªå‹¢ï¼Ÿ

**æ··åˆç­–ç•¥å»ºè­°:**

1. **åˆ†å±¤è™•ç†**: ä½¿ç”¨ TF-IDF å¿«é€Ÿç¯©é¸å€™é¸çµæœï¼Œå†ç”¨ AI ç²¾ç´°è™•ç†
2. **æˆæœ¬å„ªåŒ–**: ç°¡å–®ä»»å‹™ç”¨å‚³çµ±æ–¹æ³•ï¼Œè¤‡é›œä»»å‹™æ‰èª¿ç”¨ AI
3. **çµæœé©—è­‰**: ç”¨å‚³çµ±æ–¹æ³•çš„çµæœé©—è­‰ AI è¼¸å‡ºçš„åˆç†æ€§
4. **é›¢ç·š+åœ¨ç·š**: é›¢ç·šä½¿ç”¨å‚³çµ±æ–¹æ³•å»ºç«‹ç´¢å¼•ï¼Œåœ¨ç·šæŸ¥è©¢æ™‚çµåˆ AI ç†è§£

**å¯¦éš›æ‡‰ç”¨æ¡ˆä¾‹:**
åœ¨æ³•é™¢åˆ¤æ±ºæ›¸æª¢ç´¢ç³»çµ±ä¸­ï¼Œå¯ä»¥å…ˆç”¨ TF-IDF å¿«é€Ÿæ‰¾å‡ºç›¸é—œåˆ¤æ±ºï¼ˆé€Ÿåº¦å¿«ã€éš±ç§å®‰å…¨ï¼‰ï¼Œç„¶å¾Œç”¨ AI ç”Ÿæˆæ˜“è®€çš„æ‘˜è¦ä¾›æ³•å®˜åƒè€ƒï¼ˆå“è³ªé«˜ã€æ˜“ç†è§£ï¼‰ã€‚é€™æ¨£æ—¢ä¿è­‰äº†æ•ˆç‡å’Œå®‰å…¨ï¼Œåˆæå‡äº†ä½¿ç”¨é«”é©—ã€‚


## çµè«–

å‚³çµ± NLP æ–¹æ³•å’Œç¾ä»£ AI æ–¹æ³•å„æœ‰åƒç§‹ï¼Œç†è§£å®ƒå€‘çš„ç‰¹æ€§å’Œé©ç”¨å ´æ™¯ï¼Œæ‰èƒ½åœ¨å¯¦éš›æ‡‰ç”¨ä¸­åšå‡ºæœ€ä½³é¸æ“‡ã€‚æœªä¾†çš„è¶¨å‹¢å¯èƒ½ä¸æ˜¯ã€Œéæ­¤å³å½¼ã€ï¼Œè€Œæ˜¯ã€Œèåˆå‰µæ–°ã€ï¼Œçµåˆå…©è€…å„ªå‹¢ï¼Œé–‹ç™¼å‡ºæ›´å¯¦ç”¨ã€æ›´å¯é çš„æ–‡æœ¬è™•ç†ç³»çµ±ã€‚

---
å ±å‘Šå­—æ•¸: ç´„ 750 å­—
ç”Ÿæˆæ™‚é–“: {timestamp}
"""
    
    # é¡¯ç¤ºå ±å‘Š
    print("="*80)
    print("è³ªæ€§åˆ†æå ±å‘Š")
    print("="*80)
    print(report.format(timestamp=datetime.now().strftime('%Y-%m-%d %H:%M:%S')))
    
    # å„²å­˜å ±å‘Š
    print("\n" + "="*60)
    print("å„²å­˜åˆ†æå ±å‘Š")
    print("="*60)
    
    os.makedirs('results', exist_ok=True)
    
    # å„²å­˜ç‚º Markdown æ ¼å¼
    with open('results/c2_qualitative_analysis.md', 'w', encoding='utf-8') as f:
        f.write(report.format(timestamp=datetime.now().strftime('%Y-%m-%d %H:%M:%S')))
    
    print("âœ“ è³ªæ€§åˆ†æå ±å‘Šå·²å„²å­˜è‡³: results/c2_qualitative_analysis.md")
    
    # åŒæ™‚å„²å­˜ç‚ºç´”æ–‡å­—
    with open('results/c2_qualitative_analysis.txt', 'w', encoding='utf-8') as f:
        # ç§»é™¤ markdown æ ¼å¼æ¨™è¨˜
        text_report = report.replace('# ', '').replace('## ', '').replace('### ', '')
        text_report = text_report.replace('**', '').replace('*', '')
        f.write(text_report.format(timestamp=datetime.now().strftime('%Y-%m-%d %H:%M:%S')))
    
    print("âœ“ è³ªæ€§åˆ†æå ±å‘Šå·²å„²å­˜è‡³: results/c2_qualitative_analysis.txt")
    
    # çµ±è¨ˆå­—æ•¸
    report_text = report.replace('#', '').replace('*', '').replace('-', '').replace('\n', '')
    word_count = len([c for c in report_text if c.strip()])
    print(f"\nå ±å‘Šå­—æ•¸çµ±è¨ˆ: ç´„ {word_count} å­—")
    
    print("\n" + "="*60)
    print("âœ“ C-2 å®Œæˆï¼")
    print("="*60)


# ============================================================
# ä¸»ç¨‹å¼
# ============================================================
def main(task=None):
    """
    ä¸»ç¨‹å¼å…¥å£
    task: 'C1', 'C2', 'ALL', None
    """
    print("Part C: æ¯”è¼ƒåˆ†æå ±å‘Š")
    print("="*60)
    
    if task == 'C1':
        run_c1()
    elif task == 'C2':
        run_c2()
    elif task == 'ALL' or task is None:
        run_c1()
        run_c2()
    else:
        print(f"âš  ç„¡æ•ˆçš„ä»»å‹™: {task}")
        return
    
    print("\n" + "="*60)
    print("ğŸ‰ Part C å®Œæˆï¼")
    print("="*60)
    print("\nçµæœæª”æ¡ˆä½æ–¼ results/ è³‡æ–™å¤¾:")
    print("  â€¢ c1_quantitative_comparison.json")
    print("  â€¢ c1_quantitative_comparison.txt")
    print("  â€¢ c2_qualitative_analysis.md")
    print("  â€¢ c2_qualitative_analysis.txt")


if __name__ == "__main__":
    # æ”¯æ´å‘½ä»¤åˆ—åƒæ•¸
    if len(sys.argv) > 1:
        task = sys.argv[1].upper()
        main(task)
    else:
        main('ALL')